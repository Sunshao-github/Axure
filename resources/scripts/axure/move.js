$axure.internal(function(e){var t={};e.move=t;var o={};e.move.PrepareForMove=function(n,r,i,a,u,s,m,c){var f=s?{}:e.dynamicPanelManager.getFixedInfo(n),l=$jobj(n),p=e("#"+n),v=e.getTypeFromElementId(n)==e.constants.LAYER_TYPE;m||(m=t.getRootLayer(n))&&!c&&(e.visibility.pushContainer(m,!1),v&&(l=e.visibility.applyWidgetContainer(n,!0))),s||(s=l);var g="left",y="top",d=a?p.offsetLocation():void 0,h=a?r-d.x:r,P=a?i-d.y:i;if("right"==f.horizontal){g="right";var x=-(h=a?$(window).width()-r-e.getNumFromPx(s.css("right"))-p.width():-r)}else"center"==f.horizontal&&(g="margin-left",a&&(h=r-$(window).width()/2));if("bottom"==f.vertical){y="bottom";var b=-(P=a?$(window).height()-i-e.getNumFromPx(s.css("bottom"))-p.height():-i)}else"middle"==f.vertical&&(y="margin-top",a&&(P=i-$(window).height()/2));return o[n]={x:void 0===x?h:x,y:void 0===b?P:b,options:u},{horzX:h,vertY:P,horzProp:g,vertProp:y,rootLayer:m,jobj:s}},e.move.GetWidgetMoveInfo=function(){return $.extend({},o)},t.getRootLayer=function(t){for(var o=e.getTypeFromElementId(t)==e.constants.LAYER_TYPE?t:"",n=e("#"+t).getParents(!0,"*")[0],r=0;r<n.length;r++){var i=n[r];if(!e.public.fn.IsLayer(e.getTypeFromElementId(i)))break;o=i}return o},e.move.MoveWidget=function(t,o,r,i,a,u,s,m,c){var f=e.move.PrepareForMove(t,o,r,a,i,m);e.drag.LogMovedWidgetForDrag(t,i.dragInfo);var l=$obj(t);if(l&&e.public.fn.IsLayer(l.type)){var p=e.public.fn.getLayerChildrenDeep(t,!0);if(!c)for(var v=0;v<p.length;v++)e.move.PrepareForMove(p[v],o,r,a,i,null,f.rootLayer,!0)}if(m=f.jobj,n(t,i,u,s,m,f),!c&&(e.event.raiseSyntheticEvent(t,"onMove"),p))for(v=0;v<p.length;v++)e.event.raiseSyntheticEvent(p[v],"onMove")};var n=function(t,o,n,r,i,a){var u={};e.dynamicPanelManager.isPercentWidthPanel($obj(t))||(u[a.horzProp]="+="+a.horzX),u[a.vertProp]="+="+a.vertY,e.visibility.moveMovedLocation(t,a.horzX,a.vertY);var s=a.rootLayer,m=$addAll(i,t),c=m.length,f=function(){0==--c&&s&&e.visibility.popContainer(s,!1),n&&n(),r&&e.action.fireAnimationFromQueue(t,e.action.queueTypes.move)};if("none"===o.easing)m.css(u),s&&e.visibility.popContainer(s,!1),n&&n(),r&&e.action.fireAnimationFromQueue(t,e.action.queueTypes.move);else if("straight"===o.trajectory||0===a.horzX||0===a.vertY)m.animate(u,{duration:o.duration,easing:o.easing,queue:!1,complete:f});else{var l=e.getNumFromPx(m.css(a.horzProp)),p=e.getNumFromPx(m.css(a.vertProp)),v=a.horzX>0^a.vertY>0^"arcClockwise"===o.trajectory?function(e){return{x:l+Math.sin(e*Math.PI*.5)*a.horzX,y:p+(1-Math.cos(e*Math.PI*.5))*a.vertY}}:function(e){return{x:l+(1-Math.cos(e*Math.PI*.5))*a.horzX,y:p+Math.sin(e*Math.PI*.5)*a.vertY}},g=e.public.fn.inversePathLengthFunction(v);$({parameter:0}).animate({parameter:1},{duration:o.duration,easing:o.easing,queue:!1,step:function(e){var t=v(g(e)),o={};o[a.horzProp]=t.x,o[a.vertProp]=t.y,m.css(o)},complete:f})}};t.nopMove=function(t,n){var r=new Object;r.x=0,r.y=0,r.options={},r.options.easing="none",r.options.duration=0,o[t]=r;var i=$obj(t);e.public.fn.IsLayer(i.type)&&n.onComplete&&n.onComplete(),e.event.raiseSyntheticEvent(t,"onMove")};var r=function(t,o,n,r,i,a,u){o.x+=n.x,o.y+=n.y,0==o.x&&0==o.y?(r&&(e.action.fireAnimationFromQueue(t,e.action.queueTypes.rotate),e.action.fireAnimationFromQueue(t,e.action.queueTypes.move)),u&&u()):$jobj(t).animate({top:"+="+o.y,left:"+="+o.x},{duration:a,easing:i,queue:!1,complete:function(){r&&(e.action.fireAnimationFromQueue(t,e.action.queueTypes.move),e.action.fireAnimationFromQueue(t,e.action.queueTypes.rotate)),u&&u()}})};t.circularMove=function(t,o,n,i,a,u,s,m,c,f){var l=$jobj(t);f||(l=$addAll(l,t));var p=e.move.PrepareForMove(t,i.x,i.y,!1,s);if(0!==o){var v=function(r){var s=r-y.degree,m=e("#"+t).offsetBoundingRect().centerPoint,c=$axure.fn.getPointAfterRotate(s,m,n),f=s/o,p=(i.x+a.x)*f,v=(i.y+a.y)*f;if(u){var g={};g.x=u.x*f,g.y=u.y*f,$axure.fn.getPointAfterRotate(y.degree,g,{x:0,y:0}),p+=g.x,v+=g.y}n.x+=p,n.y+=v,a=$axure.fn.getPointAfterRotate(s,a,{x:0,y:0}),p+=c.x-m.x,v+=c.y-m.y,e.visibility.moveMovedLocation(t,p,v),p<0?l.css("left","-="+-p):p>0&&l.css("left","+="+p),v<0?l.css("top","-="+-v):v>0&&l.css("top","+="+v)},g=function(){m&&e.action.fireAnimationFromQueue(t,e.action.queueTypes.move),c&&c(),p.rootLayer&&e.visibility.popContainer(p.rootLayer,!1);var o=e.dynamicPanelManager.isPercentWidthPanel($obj(t));o&&(e.dynamicPanelManager.updatePanelPercentWidth(t),e.dynamicPanelManager.updatePanelContentPercentWidth(t)),"fixed"==l.css("position")&&(o||l.css("left",""),l.css("top",""))},y={degree:0};!s.easing||"none"===s.easing||s.duration<=0?(v(o),g()):$(y).animate({degree:o},{duration:s.duration,easing:s.easing,queue:!1,step:v,complete:g})}else r(t,i,a,m,s.easing,s.duration,c)},t.rotate=function(o,n,r,i,a,u,s){var m=t.getRotationDegree(o);if(a&&(n-=m),0!==n){var c=$jobj(o),f=function(t){var o=t-p.degree,n=m+o;c.css(e.public.fn.setTransformHowever("rotate("+n+"deg)")),m=n},l=function(){u&&e.action.fireAnimationFromQueue(e.public.fn.compoundIdFromComponent(o),e.action.queueTypes.rotate),s&&s(),e.annotation.adjustIconLocation(o)},p={degree:0};e.visibility.setRotatedAngle(o,m+n),!r||"none"===r||i<=0?(f(n),l()):$(p).animate({degree:n},{duration:i,easing:r,queue:!1,step:f,complete:l})}else u&&e.action.fireAnimationFromQueue(o,e.action.queueTypes.rotate)},t.compoundRotateAround=function(t,o,n,i,a,u,s,m,c,f){if(0!==o){var l=$jobj(t),p={degree:0};(!s||"none"===s||m<=0)&&(m=1,s="linear");var v=e.getNumFromPx(l.css("width")),g=e.getNumFromPx(l.css("height")),y=e.getNumFromPx(l.css("left")),d=e.getNumFromPx(l.css("top"));$(p).animate({degree:o},{duration:m,easing:s,queue:!1,step:function(t){var r=e.public.fn.transformFromElement(l[0]),s=y+.5*v,m=d+.5*g,c={x:s+r[4],y:m+r[5]},f=t-p.degree,h=f/o,P=(i.x+a.x)*h,x=(i.y+a.y)*h;if(u){var b={};b.x=u.x*h,b.y=u.y*h,$axure.fn.getPointAfterRotate(p.degree,b,{x:0,y:0}),P+=b.x,x+=b.y}var F=e.public.fn.rotationMatrix(f),M=e.public.fn.matrixMultiplyMatrix(F,{m11:r[0],m21:r[1],m12:r[2],m22:r[3]}),$=$axure.fn.getPointAfterRotate(f,c,n),j=e.public.fn.matrixString(M.m11,M.m21,M.m12,M.m22,$.x-s+P,$.y-m+x);l.css(e.public.fn.setTransformHowever(j))},complete:function(){c&&e.action.fireAnimationFromQueue(l.parent()[0].id,e.action.queueTypes.rotate),f&&f()}})}else r(e.public.fn.compoundIdFromComponent(t),i,a,c,s,m,f,e.action.queueTypes.rotate)},t.getRotationDegreeFromElement=function(e){if(null==e)return NaN;var t=e.style.transform||e.style["-o-transform"]||e.style["-ms-transform"]||e.style["-moz-transform"]||e.style["-webkit-transform"];if(t){var o=/rotate\(([-?0-9]+)deg\)/.exec(t);if(o&&o[1])return parseFloat(o[1])}if(!window.getComputedStyle)return console.log("rotation is not supported for ie 8 and below in this version of axure rp"),0;var n=window.getComputedStyle(e,null),r=n.getPropertyValue("transform")||n.getPropertyValue("-o-transform")||n.getPropertyValue("-ms-transform")||n.getPropertyValue("-moz-transform")||n.getPropertyValue("-webkit-transform");if(!r||"none"===r)return 0;var i=r.split("(")[1],a=(i=(i=i.split(")")[0]).split(","))[0],u=i[1],s=Math.atan2(u,a);return s<0&&(s+=2*Math.PI),s*(180/Math.PI)},t.getRotationDegree=function(o){return e.public.fn.IsLayer($obj(o).type)?$jobj(o).data("layerDegree"):t.getRotationDegreeFromElement(document.getElementById(o))}});